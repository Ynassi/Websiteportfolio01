<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yanis NASSI - Portfolio</title>
    <link rel="stylesheet" href="../css/bellabeat_style.css">
   
    <!-- PRISM / CODE VIEWER -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

</head>
<style>@font-face {
    font-family: 'Signatra';
    src: url('../fonts/Signatra.ttf') format('truetype');
}

@font-face {
    font-family: 'Helvetica';
    src: url('../fonts/Helvetica.ttc') format('truetype');
}
@font-face {
font-family: "Courier New";
src: url("../fonts/cour.ttf");
font-weight: 400;
}
/* Styles globaux */
body {
    background-color: #202020;  /* Gris foncé */
    color: #ffffff;  /* Blanc */
    font-family: 'Helvetica', sans-serif;
    text-align: center;
}

/* HEADER */
header {
    background-color: #181818; /* Gris encore plus foncé */
    padding: 10px 50px; /* Réduction plus douce */
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #333;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 10;
}

/* Partie gauche du header */
.header-left {
    display: flex;
    align-items: center;
}

.logo {
    height: 65px; /* Taille augmentée */
    margin-right: 40px;
}

.name {
    font-family: 'Signatra', sans-serif;  
    font-size: 2.8rem; /* Taille légèrement plus grande pour l'équilibre */

    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
    margin: 0;
    padding: 0;
    line-height: 1.1;
}

/* Liens du header */
.header-right {
    display: flex;
    gap: 30px;
    margin-right: 80px;
}

.header-right a {
    font-size: 1.6rem;
    color: #f0f0e6 !important;
    text-decoration: none !important;
    transition: color 0.3s;
}

.header-right a:hover {
    color: #00bfff;
}</style>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-left">
            <a href="../index.html" class="home-link">
            <img src="../images/clipart.png" alt="Logo" class="logo img-sm">
            <h1 class="name">Yanis NASSI</h1>
         </a>
        </div>
        <nav class="header-right">
            <a href="../pages/portfolio.html">Portfolio</a>
            <a href="../pages/skills.html">Skills</a>
            <a href="../pages/art.html">Art</a>
            <a href="../pages/contact.html">Contact</a>
        </nav>
    </header>
    
    <!-- CONTENU PRINCIPAL -->
    <main>
        
        <img style="width: 100%;" loading="lazy" alt="" src="../images/images_bellabeat/Bellabeat banniere.JPG" />
        <h1 class="title_cyclistic"> BELLABEAT CASE STUDY</h1>
        <div>
            <h2 class="paragraph_title">SCENARIO</h2>

            <p>As a junior data analyst, I'm recently working for a company named <b>Bellabeat</b>. Bellabeat is an high-tech manufacturer of <b>health-focused smart devices for women</b> founded in 2013 
                by <b>Urška Sršen & Sando Mur</b>. Here are some examples of bellabeat products :</p>
      
            <ul class="bullet-list">
              <li><p><b>Bellabeat app :</b> The Bellabeat app provides users with health data related to their activity, sleep, stress,menstrual cycle, and mindfulness habits.
                This data can help users better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of sma wellness products.</p></li>
              <li><p><b>Leaf</b> Bellabeat’s classic wellness tracker can be worn as a bracelet, necklace, or clip. The Leaf tracker connects to the Bellabeat app to track activity, sleep, and stress.</p></li>
              <li><p><b>Time:</b> This wellness watch combines the timeless look of a classic timepiece with sma technology to track user activity, sleep, and stress. 
                The Time watch connects to the Bellabeat app to provide you with insights into your daily wellness.</p></li>
              <li><p><b>Spring:</b> This is a water bottle that tracks daily water intake using sma technology to ensure that you are appropriately hydrated throughout the day. 
                The Spring bole connects to the Bellabeat app to track your hydration levels.</p></li>
              <li><p><b>Bellabeat membership</b>Bellabeat also offers a subscription-based membership program for users. 
                Membership gives users 24/7 access to fully personalized guidance on nutrition, activity, sleep, health and beauty, 
                and mindfulness based on their lifestyle and goals.</p></li>
             </ul>
       
            <h2 class="paragraph_title">BUSINESS TASK</h2>
            <p>
                To better understand their <b>customer needs and the smart devices market</b>, Urška Sršen asked me to conduct an analysis. 
                We want to identify the <b>trends in smart device usage</b>, see how these trends can apply to Bellabeat customers and <b>help Bellabeat build a data driven marketing strategy</b>. 
                I'll have <b>a week</b> to conduct the analysis and share it with the Bella beat marketing analytics team. But I'll force myself to do it in <b>3 days</b> without having to lower the 
                quality of my study just to see how I would react to tight deadlines.
            </p>
            <h2 class="paragraph_title"> ASK</h2>
            <p>
                To define what kind of trend we want to identify in smart devices usage, we will try to answer a few questions :
            </p>
            <ul class="bullet-list">
                <li><p>Do users always wear their device ? and if not when do they remove it ? What is the percentage of users that always wear their device ? </p></li>
                <li><p>What motivates users to wear smart devices ? Sport ? Biometrics tracking ?
                    Are there users that do sport without going into the app ? 
                </p></li>
                <li><p>What are the days of the week in which users use the app the most ? </p></li>
                <li><p>What are the Sleep, Weight, Intensities of activities and calories burning trends among users</p></li>
                <li><p>What is the percentage of users that use Weight monitoring and why ?</p></li>
                <li><p>What are the customers "types”</p></li>
               </ul>
            <p>Id love to ask more question to Urška on the data she provided me to clarify some points. 
                In a real life situation I would reach out to my supervisors to be sure I'm heading the good way with my analysis.</p>

            <h2 class="paragraph_title">GET THE DATA READY</h2>
            <p> In the case study, a <b>Kaggle</b> Dataset is provided containing data from 2016 on <b>30 random Fitbit Users</b>.  
                First, we will perform The <b>ROCC test</b> to see if we can trust the dataset :
            </p>
            <ul class="bullet-list">
                <li><p>Dataset is <b>RELIABLE : LOW </b> In this case the dataset is not really representative of the population, 
                    30 people can't really represent all the customers of a global company like bellabeat.</p></li>
                <li><p>Dataset is <b>ORIGINAL : MEDIUM </b> The dataset is provided by MOBIUS which seems to be a trustworthy source on Kaggle as he is a steady and respected contributor (Lots of medals and considered a Dataset Master). 
                    But it is still third party data.</li>
                <li><p>Dataset is <b>COMPLETE & UNDERSTANDABLE : LOW</b> Dataset misses a lot of information. Lots of information is missing, 
                    in the “Daily_Activity” there are missing records for a lot of customers. We would also need gender info as Bellabeat is a women-oriented company. 
                    Data is not well explained as there is no metadata. We do our best to make assumptions on data. </p></li>
                <li><p>Dataset is <b>CURRENT : LOW</b> Dataset is not current as it is 10 years old now, smart devices users might have changed their habits.</p></li>
                <li><p>Dataset <b>CITED : LOW</b> Dataset comes from a distributed survey via Amazon Mechanical Turk, so yes it is cited but not from a very reliable source</p></li>
               </ul>

            <p>
                <b>RELIABILITY</b> issue : The dataset provided is already huge, there are approximately <b>2 millions observations</b> by table and there are <b>7 tables by period for 2 periods of time</b>. For technical reasons it will be difficult to deal with a bigger dataset on my personal laptop . 
                As it is a Case study <b>we will perform the analysis on this sample size</b> but the recommendations i’ll do couldn't really apply in a real life scenario. 
            </p>
            <p>
                Source is not really <b>UNDERSTANDABLE</b>: I'll try to make assumptions on the data.
            </p>
            <p>
                Source is <b>OUTDATED </b>:  As it is a Case study we will still perform the analysis on this <b>outdated data</b> but the recommendations i’ll do couldn't really apply in a real life scenario.    
            </p>
            <p>
                <b>Fitness data</b> about users seems to be really <b>hard to find</b> as there might be some <b>confidentiality issues</b> in sharing it publicly. 
                I searched <b>BigQuery public</b> datasets and <b>fitabase</b> to find better data and couldn't find it for free. As this case study is provided by google (a trustworthy source) 
                and that i can't just “give up”,  i'll take this case study as <b>a challenge to make sense out of this dataset by making assumptions on the data</b>. 
                It can also be seen as an opportunity to do an analysis on Data inconsistency and explain why this dataset is a really bad one which should never be used to 
                make data driven decisions.
            </p>
            <p>
                The Kaggle dataset is organized in 2 folders containing the same type of tables for 2 months in 2016 (march and april).
            </p><p>  </p>
            <p>We have 3 types of data :</p>
            <ol class="arabic-list">
                <li><p>
                    The data that is <b>continuously recorded by the device</b>, there is data as long as the user is <b>wearing the device</b>. 
                    We have different types of metrics (Calories, Sleep, MET, Intensity, Steps) 
                 </p>
                 <p>
                    There are different files for the same metrics (minutes, hour and day) . I'll import just the metrics by minutes for <b>Calories Sleep and Intensity</b>.
                 </p>
                 <ul class ="bullet-list">
                    <li><b>Calories :</b> Calories burnt by minute. (continuous entire number)</li>
                    <li><b>Intensity :</b> Intensity of the activity made by the user by minute. (0,1,2,3)</li>
                    <li><b>Sleep :</b> There is a record if the user is asleep (1,2 or 3 for the recovering quality of sleep)</li>
                 </ul>
                 <p>We have the same tables for April and March</p>
                </li>
                <li><p>The user logs into the app to record activity himself, 
                    he asks for a report on this day or he just opens the app which automatically generates a record for the day. 
                    There is just one table by month called <b>DailyActivity</b> (by day).</p></li>
                <li>
                    <p>The user enters the data himself on the app. Also one table by month called <b>WeightLogInfo.</b> (We will discuss this point later on the analysis part)</p>
                </li>
            </ol>
            <p>
                I came up with this classification because we have way more data in the table "Continuous_record" than “DailyActivity”. 
                WeightLogInfo is the one with the least data (maybe because it requires more effort from the user). 
                A table called <b>SleepDay</b> is also available only for the month of april. We use the table to know how many people track their sleep on the total population. 
            </p>
            <p><b>DATA CHOICE EXPLANATION</b></p>
            <p><ul class ="bullet-list">
                <li><b>Calories :</b> if there is a record the user was wearing the watch.</li>
                <li><b>Intensity :</b>  To see if there is some sport activity untracked by the app.</li>
                <li><b>Sleep :</b> there is data only if the user is asleep so we can track sleeping habits of users and maybe link it to other habits they have.</li>
             </ul>
            </p>
            <h2 class="paragraph_title">PROCESS</h2>
            <p>We will use <b>BigQuery and Tableau</b> to perform this analysis.</p>
            <p>
                As I was trying to import data to BigQuery I noticed there was some <b>invalid format in the dates</b>. 
                I tried to automatise the cleaning on Google Sheets but couldn't manage to switch AM/PM hours to 24h based timestamp. 
                I tried to clean it on <b>RStudio</b> and finally succeeded in setting the appropriate timestamp for my data. Here is the process :
            </p>
            <div class="language-r"><pre><code class="language-r"> ## Charger les bibliothèques nécessaires
   library(dplyr)
   library(lubridate)
                
## Charger les données
   data <- read.csv("/Users/msayn47painter/Desktop/CASE_STUDY_Bellabeat
                     /Bellabeat_data/April_data
                     /Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
                
## Vérifier que la colonne est bien en texte
    data$Date <- as.character(data$Date)
                
## Convertir les dates en format Date-Time avec heure en 24h
    data$Date <- mdy_hms(data$Date)
                
## Forcer l'affichage des heures, même pour minuit (00:00:00)
    data$Date <- strftime(data$Date, format="%Y-%m-%d %H:%M:%S")
                
## Sauvegarder le fichier nettoyé en CSV
    write.csv(data, "/Users/msayn47painter/Desktop/CASE_STUDY_Bellabeat/Bellabeat_data/April_data
                     /CleanedData_april/WeightLogInfo_april.csv", row.names = FALSE, quote = FALSE)
                </code></pre></div>
           <p>I did the same operation for all tables.</p>
           <p> Now we have to organize the data to better understand it and clean it. First I'll group these 3 tables (Sleep, Intensity and Calories) in one with the following columns </p>
          <div class="data-list">
             <div><b>Id :</b><span> fitbit user id</span></div>
             <div><b>Activity minute :</b><span>Minute in which record happens</span></div>
             <div><b>Calories :</b><span>Calories burnt at this time</span></div>
             <div><b>Intensity :</b><span>0 if the user is awake 1 2 3 he or she sleeps.</span></div>
           </div>
           <p> As it is more complete, We'll use the data by minutes tables and use it to create a table by hours: <b>Continuous_record (minutes) and Continuous_hours</b></p>
           <div class="language-r"><pre><code class="language-r">-- march

            CREATE TABLE `nimble-mode-447321-p1.bellabeat.Continuous_record_march` AS
            WITH 
                calories AS (
                    SELECT 
                        ActivityMinute AS date,  
                        Calories,
                        id  -- Ajout de la colonne id de Calories_march
                    FROM `nimble-mode-447321-p1.bellabeat.Calories_march`
                ),
                sleep AS (
                    SELECT 
                        date,  
                        Value 
                    FROM `nimble-mode-447321-p1.bellabeat.Sleep_march`
                ),
                intensities AS (
                    SELECT 
                        ActivityMinute AS date,  
                        Intensity 
                    FROM `nimble-mode-447321-p1.bellabeat.Intensities_march`
                )
            SELECT 
                c.date AS ActivityMinute, 
                c.id,  
                MAX(c.Calories) AS Calories,  
                COALESCE(MAX(s.Value), 0) AS Sleep_Value, 
                MAX(i.Intensity) AS Intensity  
            FROM calories c
            LEFT JOIN sleep s ON c.date = s.date  
            LEFT JOIN intensities i ON c.date = i.date  
            GROUP BY c.date, c.id
            
-- april 
            
            CREATE TABLE `nimble-mode-447321-p1.bellabeat.Continuous_record_april` AS
            WITH 
                calories AS (
                    SELECT 
                        ActivityMinute AS date,  
                        Calories,
                        id  
                    FROM `nimble-mode-447321-p1.bellabeat.Calories_april`
                ),
                sleep AS (
                    SELECT 
                        date,  
                        Value 
                    FROM `nimble-mode-447321-p1.bellabeat.Sleep_april`
                ),
                intensities AS (
                    SELECT 
                        ActivityMinute AS date,  
                        Intensity 
                    FROM `nimble-mode-447321-p1.bellabeat.Intensities_april`
                )
            SELECT 
                c.date AS ActivityMinute, 
                c.id,  
                MAX(c.Calories) AS Calories, 
                COALESCE(MAX(s.Value), 0) AS Sleep_Value,  
                MAX(i.Intensity) AS Intensity  
            FROM calories c
            LEFT JOIN sleep s ON c.date = s.date  
            LEFT JOIN intensities i ON c.date = i.date  
            GROUP BY c.date, c.id</code></pre></div>
            <p>We will also use the table <b>DailyActivity (daily Data)</b></p>
            
            <div class="data-list">
            <div><b>Id :</b><span> Fitbit user id</span></div>
            <div><b>Activity Date :</b><span>Date in which record happens</span></div>
            <div><b>TotalSteps :</b><span>Total steps the day of the record</span></div>
            <div><b>TotalDistance :</b><span>Total distance traveled (Fitbit and logged activity)</span></div>
            <div><b>TrackerDistance :</b><span>Total distance traveled recorded by device</span></div>
            <div><b>LoggedActivitiesDistance :</b><span>Total distance entered by the user manually</span></div>
            <div><b>VeryActiveDistance :</b><span>Total distance being very Active (Running or sport)</span></div>
            <div><b>ModeratelyActiveDst:</b><span>Total distance being moderately active (light sport session, manual work, walking fast) </span></div>
            <div><b>LightActiveDistance:</b><span>Total distance being lightly active (Cooking, walking,groceries family meeting or light activities)</span></div>
            <div><b>VeryActiveMinutes :</b><span>Total minutes being Very active</span></div>
            <div><b>FailyActiveMinutes :</b><span>Total minutes being Fairly active</span></div>
            <div><b>LightlyActiveMinutes:</b><span>Total minutes being Lightly active</span></div>
            <div><b>SedentaryMinutes :</b><span>Total minutes being Sedentary</span></div>
            <div><b>Calories :</b><span>Total calories burnt during the day</span></div>
          </div>
          <p>And the table <b>WeighLogInfo (Daily Data) :</b></p>
          <div class="data-list">
            <div><b>Id :</b><span> Fitbit user id</span></div>
            <div><b>Date :</b><span>Date of record</span></div>
            <div><b>WeightKg :</b><span>Total steps the day of the record</span></div>
            <div><b>WeightPounds :</b><span>Total distance traveled (Fitbit and logged activity)</span></div>
            <div><b>Fat :</b><span>fat index</span></div>
            <div><b>BMI :</b><span>Body Mass Index</span></div>
            <div><b>IsManualReport :</b><span>TRUE/FALSE </span></div>
          </div>
          <p>And Finally the table <b>SleepDay :</b></p>
          <div class="data-list">
            <div><b>Id :</b><span> Fitbit user id</span></div>
            <div><b>SleepDay :</b><span>Day of record</span></div>
            <div><b>TotalSleepRecords :</b><span>Number of sleep record</span></div>
            <div><b>TotalMinutesAsleep :</b><span>Total minutes being Asleep</span></div>
            <div><b>TotalMintesInBed :</b><span>Total minutes being in Bed</span></div>
          </div>
        <h2 class="paragraph_title"> DATA CLEANING</h2>
        <p><b><u>DATA MERGING</u></b> :</p>
        <p> First it is important to merge the data from both monthes to have all the data in the same table</p>

<div class="language-r"><pre><code class="language-r">
-- Continuous record
INSERT INTO `nimble-mode-447321-p1.bellabeat.Continuous_record` 
(id, ActivityMinute, Calories, Sleep_Value, Intensity)
SELECT id, ActivityMinute, Calories, Sleep_Value, Intensity
FROM `nimble-mode-447321-p1.bellabeat.Continuous_record_april`
UNION ALL
SELECT id, ActivityMinute, Calories, Sleep_Value, Intensity
FROM `nimble-mode-447321-p1.bellabeat.Continuous_record_march`;
    
-- Dailyactivity 
CREATE TABLE `nimble-mode-447321-p1.bellabeat.Dailyactivity` AS
SELECT * FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity_april`
UNION ALL
SELECT * FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity_march`;
    
-- WeightLogInfo 
CREATE TABLE `nimble-mode-447321-p1.bellabeat.WeightLogInfo` AS
SELECT * FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo_april`
UNION ALL
SELECT * FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo_march`;</code></pre></div>
       <p>
        <u>Checking <b>FORMATS</b></u> :
      </p>
      <div class="language-r">
        <pre><code class="language-r">
SELECT column_name, data_type
FROM `nimble-mode-447321-p1.bellabeat.INFORMATION_SCHEMA.COLUMNS`
WHERE table_name = 'Continuous_record';

SELECT column_name, data_type
FROM `nimble-mode-447321-p1.bellabeat.INFORMATION_SCHEMA.COLUMNS`
WHERE table_name = 'DailyActivity';

SELECT column_name, data_type
FROM `nimble-mode-447321-p1.bellabeat.INFORMATION_SCHEMA.COLUMNS`
WHERE table_name = 'WeightLogInfo';</code></pre></div>

<p><b>Continuous_record :</b></p>
<table class="custom-table">
    <tr>
        <td>Column</td>
        <td>Format</td>
    </tr>
    <tr>
        <td>ID</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>Activity Minute</td>
        <td>TIMESTAMP</td>
    </tr>
    <tr>
        <td>Calories</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>Sleep_Value</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>Intensity</td>
        <td>INT64</td>
    </tr>
</table>

<p><b>DailyActivity :</b></p>
<table class="custom-table">
    <tr>
        <td>Column</td>
        <td>Format</td>
    </tr>
    <tr>
        <td>ID</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>Activity Date</td>
        <td>DATE</td>
    </tr>
    <tr>
        <td>TotalSteps</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>TotalDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>LoggedActivitiesDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>VeryActiveDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>ModeratelyActiveDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>LightActiveDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>SedentaryActiveDistance</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>VeryActiveMinutes</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>LoggedActivitiesDistance</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>VeryActiveDistance</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>FairlyActiveMinutes</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>SedentaryMinutes</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>SedentaryActiveDistance</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>Calories</td>
        <td>INT64</td>
    </tr>
</table>
<p><b>WeightLogInfo :</b></p>
<table class="custom-table">
    <tr>
        <td>Column</td>
        <td>Format</td>
    </tr>
    <tr>
        <td>ID</td>
        <td>INT64</td>
    </tr>
    <tr>
        <td>Date</td>
        <td>TIMESTAMP</td>
    </tr>
    <tr>
        <td>WeightKg</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>WeightPounds</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>Fat</td>
        <td>STRING</td>
    </tr>
    <tr>
        <td>BMI</td>
        <td>FLOAT64</td>
    </tr>
    <tr>
        <td>IsManualReport</td>
        <td>BOOL</td>
    </tr>
    <tr>
        <td>LogId</td>
        <td>INT64</td>
    </tr>
</table>
<p>All the tables have a good data format (except "fat" which should be a Int64 but as the colum is empty we'll ignore this format).</p>

     <p><u>Checking for <b>NULL values</u></b> :
    </p><div class="language-r">
      <pre><code class="language-r">
SELECT 
    COUNT(*) AS total_rows,
    COUNTIF(id IS NULL) AS missing_id,
    COUNTIF(ActivityMinute IS NULL) AS missing_activity_minute,
    COUNTIF(Calories IS NULL) AS missing_calories,
    COUNTIF(Sleep_Value IS NULL) AS missing_sleep_value,
    COUNTIF(Intensity IS NULL) AS missing_intensity
FROM `nimble-mode-447321-p1.bellabeat.Continuous_record`;
    
SELECT 
    COUNT(*) AS total_lignes,
    COUNTIF(Id IS NULL) AS id_nulls,
    COUNTIF(ActivityHour IS NULL) AS activityhour_nulls,
    COUNTIF(Calories IS NULL) AS calories_nulls,
    COUNTIF(Sleep_Value IS NULL) AS sleep_value_nulls,
    COUNTIF(Intensity IS NULL) AS intensity_nulls
FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity`;
    
    
SELECT 
    COUNT(*) AS total_lignes,
    COUNTIF(Id IS NULL) AS id_nulls,
    COUNTIF(Date IS NULL) AS date_nulls,
    COUNTIF(WeightKg IS NULL) AS weightkg_nulls,
    COUNTIF(WeightPounds IS NULL) AS weightpounds_nulls,
    COUNTIF(Fat IS NULL) AS fat_nulls,
    COUNTIF(BMI IS NULL) AS bmi_nulls,
    COUNTIF(IsManualReport IS NULL) AS ismanualreport_nulls,
    COUNTIF(LogId IS NULL) AS logid_nulls
FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo`;
</code></pre></div>
<p>
    No NULL Values
</p>
    <p>
    <u>Checking for <b>ABNORMAL VALUES</b></u>: 
    </p>
    <div class="language-r">
      <pre><code class="language-r">
SELECT 
    COUNT(*) AS total_lignes,
    COUNTIF(Calories < 0) AS calories_negatives,
    COUNTIF(Sleep_Value NOT IN (0,1,2,3)) AS sleep_value_invalides,
    COUNTIF(Intensity NOT IN (0,1,2,3)) AS intensity_invalides
FROM `nimble-mode-447321-p1.bellabeat.Continuous_record`;
    
SELECT 
    COUNT(*) AS total_lignes,
    COUNTIF(Total_Calories < 0) AS calories_negatives,
    COUNTIF(Sleep_Value NOT IN (0,1,2,3)) AS sleep_value_invalides,
    COUNTIF(Intensity NOT IN (0,1,2,3)) AS intensity_invalides
FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo`;
    
SELECT 
    COUNT(*) AS total_lignes,
    COUNTIF(TotalSteps < 0) AS total_steps_negatifs,
    COUNTIF(TrackerDistance < 0) AS tracker_distance_negatifs,
    COUNTIF(VeryActiveDistance < 0) AS very_active_distance_negatifs,
    COUNTIF(ModeratelyActiveDistance < 0) AS moderately_active_distance_negatifs,
    COUNTIF(LightActiveDistance < 0) AS light_active_distance_negatifs,
    COUNTIF(SedentaryActiveDistance < 0) AS sedentary_active_distance_negatifs,
    COUNTIF(VeryActiveMinutes < 0) AS very_active_minutes_negatifs,
    COUNTIF(FairlyActiveMinutes < 0) AS fairly_active_minutes_negatifs,
    COUNTIF(LightlyActiveMinutes < 0) AS lightly_active_minutes_negatifs,
    COUNTIF(SedentaryMinutes < 0) AS sedentary_minutes_negatifs,
    COUNTIF(Calories < 0) AS calories_negatives
FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity`
  </code></pre></div>
  <p>
    There are some missing values in WeightLogInfo for "Fat", We ll keep everything and discuss it later.
  </p>
  <p><u> Checking for <b>DUPLICATES</b></u> :</p>
<div class="language-r">
<pre><code class="language-r">
SELECT Id, ActivityMinute, COUNT(*) AS nb_occurences
    FROM `nimble-mode-447321-p1.bellabeat.Continuous_record`
    GROUP BY Id, ActivityMinute
    HAVING COUNT(*) > 1;
    
SELECT Date, id, COUNT(*) AS nb_occurences
    FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo`
    GROUP BY Date, id
    HAVING COUNT(*) > 1;
    
SELECT ActivityDate, id, COUNT(*) AS nb_occurences
    FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity`
    GROUP BY ActivityDate, id
    HAVING COUNT(*) > 1;</code></pre></div>
<p><u>Deleting <b>DUPLICATES</b></u></p>
<div class="language-r">
    <pre><code class="language-r">
REPLACE TABLE `nimble-mode-447321-p1.bellabeat.Continuous_record` AS
SELECT DISTINCT
    ActivityMinute, 
    id, 
    Calories, 
    Sleep_Value, 
    Intensity
FROM `nimble-mode-447321-p1.bellabeat.Continuous_record`
GROUP BY ActivityMinute, id, Calories, Sleep_Value, Intensity;
        
REPLACE TABLE `nimble-mode-447321-p1.bellabeat.DailyActivity` AS
SELECT DISTINCT 
    Id, 
    ActivityDate, 
    TotalSteps, 
    TrackerDistance, 
    LoggedActivitiesDistance, 
    VeryActiveDistance, 
    ModeratelyActiveDistance, 
    LightActiveDistance, 
    SedentaryActiveDistance, 
    VeryActiveMinutes, 
    FairlyActiveMinutes, 
    LightlyActiveMinutes, 
    SedentaryMinutes, 
    Calories
FROM `nimble-mode-447321-p1.bellabeat.DailyActivity`;
        
REPLACE TABLE `nimble-mode-447321-p1.bellabeat.WeightLogInfo` AS
SELECT DISTINCT 
    Id, 
    Date, 
    WeightKg, 
    WeightPounds, 
    Fat, 
    BMI, 
    IsManualReport, 
    LogId
FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo`;
        </code></pre></div>
<p><u>Checking for <b>DATA INCONSISTENCY</b> :</u></p>
<div class="language-r">
    <pre><code class="language-r">

        SELECT DISTINCT id
        FROM `nimble-mode-447321-p1.bellabeat.Continuous_record` 

        SELECT DISTINCT id
        FROM `nimble-mode-447321-p1.bellabeat.Continuous_hours`

        SELECT DISTINCT id
        FROM `nimble-mode-447321-p1.bellabeat.Dailyactivity`

        SELECT DISTINCT id
        FROM `nimble-mode-447321-p1.bellabeat.WeightLogInfo`

        SELECT DISTINCT id
        FROM `nimble-mode-447321-p1.bellabeat.SleepDay`
    </code></pre></div>

<p>
    <u><b>Users</b></u> : 
</p>
<p>
    <b>35 users</b> in Continuous_record
    <b>35 users</b> in DailyActivity
    <b>24 users</b> in SleepDay
    <b>13 users</b> in WeightLogInfo
</p>

<p><u>Generating <b>MORE DATA</b> :</u></p>
<p>
    We can now generate more data from our cleaned Tables.
    First we will create a table by hour from the table "<b>Continuous_record</b>" :
</p>
<div class="language-r">
<pre><code class="language-r">
-- Continuous record en heures

CREATE TABLE `nimble-mode-447321-p1.bellabeat.Continuous_hours` AS
WITH aggregated_data AS (
    SELECT
        EXTRACT(DATE FROM ActivityMinute) AS Date,  -- Extraire la date
        EXTRACT(HOUR FROM ActivityMinute) AS Hour,  -- Extraire l'heure
        id,
        ROUND(Calories) AS Calories,  -- Arrondir les calories avant d'agréger
        Sleep_Value,
        Intensity
    FROM `nimble-mode-447321-p1.bellabeat.Continuous_record`
)
SELECT
    Date,
    Hour,
    id,
    SUM(Calories) AS Total_Calories,  -- Somme des calories pour chaque heure
    ROUND(AVG(Sleep_Value)) AS Sleep_Value,  -- Moyenne arrondie pour Sleep_Value
    ROUND(AVG(Intensity)) AS Intensity  -- Moyenne arrondie pour Intensity
FROM aggregated_data
GROUP BY
    Date, Hour, id
ORDER BY
    Date, Hour, id;
</code></pre></div>
<p>
    We'll call this table "<b>Continuous_hours</b>"
</p>
<p>
    Then, We're will create <b>new columns</b> for our tables.
</p>
<p>
    We can add A column to track the day of the week in "<b>DailyActivity</b>" :
</p>
<div class="language-r">
<pre><code class="language-r">
REPLACE TABLE `nimble-mode-447321-p1.bellabeat.DailyActivity` AS
SELECT 
    Id,
    ActivityDate,
    EXTRACT(DAYOFWEEK FROM ActivityDate) AS DayOfWeek,
    TotalSteps,
    TrackerDistance,
    LoggedActivities,
    VeryActiveDistance,
    ModeratelyActiveDistance,
    LightActiveDistance,
    SedentaryActiveDistance,
    VeryActiveMinutes,
    FairlyActiveMinutes,
    LightlyActiveMinutes,
    SedentaryMinutes,
    Calories
FROM 
`nimble-mode-447321-p1.bellabeat.DailyActivity`;
</code></pre></div>
<p>
    We can add a new column to know the DayoftheWeek in <b>"Continuous_hours"</b>.
</p>
<div class="language-r">
<pre><code class="language-r">
REPLACE TABLE `nimble-mode-447321-p1.bellabeat.Continuous_hours` AS
SELECT 
    Date,
    Hour,
    id,
    EXTRACT(DAYOFWEEK FROM Date) AS DayOfWeek,
    Total_Calories,
    Sleep_Value,
    Intensity
FROM 
    `nimble-mode-447321-p1.bellabeat.Continuous_hours`
</code></pre></div>
<p>
    We will do the same for <b>each table</b>.
</p>
<p>
    To have hints about users <b>Inactivity</b> we can create a table from <b>"Continuous_hours"</b>.
</p>
<div class="language-r">
    <pre><code class="language-r">WITH
ordered_data AS (
    SELECT
    id,
    Date,
    Hour,
    LAG(TIMESTAMP(CONCAT(CAST(Date AS STRING), ' ', CAST(Hour AS STRING), ':00:00'))) 
        OVER (PARTITION BY id ORDER BY Date, Hour) AS previous_activity,
    TIMESTAMP_DIFF(
        TIMESTAMP(CONCAT(CAST(Date AS STRING), ' ', CAST(Hour AS STRING), ':00:00')), 
        LAG(TIMESTAMP(CONCAT(CAST(Date AS STRING), ' ', CAST(Hour AS STRING), ':00:00'))) 
        OVER (PARTITION BY id ORDER BY Date, Hour),
        HOUR
    ) AS time_diff
    FROM
    `nimble-mode-447321-p1.bellabeat.Continuous_hours`
),
inactivity_periods AS (
    SELECT
    id,
    previous_activity AS inactivity_start,
    TIMESTAMP(CONCAT(CAST(Date AS STRING), ' ', CAST(Hour AS STRING), ':00:00')) AS inactivity_end,
    TIMESTAMP_DIFF(
        TIMESTAMP(CONCAT(CAST(Date AS STRING), ' ', CAST(Hour AS STRING), ':00:00')), 
        previous_activity, HOUR
    ) AS inactivity_duration
    FROM
    ordered_data
    WHERE
    time_diff > 1  -- Si l'écart entre les horaires est supérieur à 1 heure
)
SELECT
id,
inactivity_start,
inactivity_end,
inactivity_duration
FROM
inactivity_periods
ORDER BY
id, inactivity_start;
</code></pre></div>
<p>
    We'll call this table "<b>Inactivity_continuous</b>"
    it shows the periods of time that has more than 1 hour between 2 records.
</p>
<p>
   We have a "Sedentary" timespan in "DailyActivity". We ll add a table to track time spent <b>Sedentary but not in bed</b>.
   The table "SleepDay" is only available for April so we will do an average for time in bed by user and substract it from "SedentaryTime".
</p>
<div class="language-r">
    <pre><code class="language-r">WITH AverageTimeInBed AS (
    SELECT 
        Id, 
        AVG(TotalTimeInBed) AS AvgTimeInBed
    FROM 
        nimble-mode-447321-p1.bellabeat.SleepDay
    GROUP BY 
        Id
)

SELECT 
    da.*, -- Sélectionne toutes les colonnes de DailyActivity
    COALESCE(atb.AvgTimeInBed, 0) AS AvgTimeInBed, 
    da.SedentaryMinutes - COALESCE(atb.AvgTimeInBed, 0) AS Sedentary_notinbed 
FROM 
    nimble-mode-447321-p1.bellabeat.DailyActivity da
LEFT JOIN 
    AverageTimeInBed atb
    ON da.Id = atb.Id;
</code></pre></div>
<p>
Now we have to check for <b>negtive values</b> in this table.
</p>
<div class="language-r">
    <pre><code class="language-r">SELECT *
FROM nimble-mode-447321-p1.bellabeat.DailySedentary_notinbed
WHERE Sedentary_notinbed < 0;
</code></pre></div>
<p>
    There are <b>61 records</b> with negative values on a 1397 total records (4%). User 6117666160 combine 12 of these 61 records. Lets now check for time spent sedentary but not <b>Asleep</b> :
</p>
<div class="language-r">
    <pre><code class="language-r">WITH AverageMinutesAsleep AS (
    SELECT 
        Id, 
        AVG(TotalMinutesAsleep) AS AvgMinutesAsleep
    FROM 
        nimble-mode-447321-p1.bellabeat.SleepDay
    GROUP BY 
        Id
)        
SELECT 
    da.*, -- Select all columns from DailyActivity
    COALESCE(ams.AvgMinutesAsleep, 0) AS AvgMinutesAsleep, 
    da.SedentaryMinutes - COALESCE(ams.AvgMinutesAsleep, 0) AS Sedentary_notAsleep
FROM 
    nimble-mode-447321-p1.bellabeat.DailyActivity da
LEFT JOIN 
    AverageMinutesAsleep ams
    ON da.Id = ams.Id; </code></pre></div>
<p>We still have </b> 47 negative values</b> in column "Sedentary_notAsleep" for this table. We ll try to give an explanation for that later.</p>
<p> One last table will be created to check for record "Hight Intensity Activity" in Continuous_hours without record in "DailyActivity" (to know what is the share of people who do sports without tracking it in the App</p>
<div class="language-r">
    <pre><code class="language-r">SELECT DISTINCT ch.Id, ch.Date
FROM nimble-mode-447321-p1.bellabeat.Continuous_hours ch
LEFT JOIN nimble-mode-447321-p1.bellabeat.DailyActivity da 
    ON ch.Id = da.Id AND ch.Date = da.ActivityDate
WHERE ch.Intensity = 3
  AND da.Id IS NULL;</code></pre></div>
  <h2 class="paragraph_title">ANALYSIS</h2>
  <p>Now we can enter the most exciting part of this study : <b>the Analysis</b>. 
    To better understand our data, we’ll use <b>Tableau</b> to make visualizations. 
    Data patterns and trends will be more accessible that way. Unfortunately I'm using 
  <b>Tableau public</b> and there is no way I can directly link Tableau to Big Query. 
    I have no choice but to download the tables from BigQuery through Google Cloud Storage 
    as CSV files and upload it to Tableau. For security reasons i wont put the Query 
    containing my google bucket name publicly on this website.</p>
    <p class = "subtitle_analysis"><b>INACTIVITY ANALYSIS</b></p>
    <div class='tableauPlaceholder' id='viz1739601624878' style='position: relative'>
        <noscript><a href='#'><img alt='INACTIVITY DASHBOARD ' 
            src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;BE&#47;BELLABEATINACTIVEDASHBOARD&#47;INACTIVITYDASHBOARD&#47;1_rss.png' 
            style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' 
            value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
            <param 
            name='embed_code_version' 
            value='3' /> <param 
            name='site_root' 
            value='' /><param 
            name='name' 
            value='BELLABEATINACTIVEDASHBOARD&#47;INACTIVITYDASHBOARD' /><param 
            name='tabs' 
            value='no' /><param 
            name='toolbar' 
            value='yes' /><param 
            name='static_image' 
            value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;BE&#47;BELLABEATINACTIVEDASHBOARD&#47;INACTIVITYDASHBOARD&#47;1.png' /> 
            <param 
            name='animate_transition' 
            value='yes' /><param 
            name='display_static_image' 
            value='yes' /><param 
            name='display_spinner' 
            value='yes' /><param 
            name='display_overlay' 
            value='yes' /><param 
            name='display_count' 
            value='yes' /><param 
            name='language' 
            value='fr-FR' /></object></div>                
            <script 
            type='text/javascript'>                    
            var divElement = document.getElementById('viz1739601624878');                   
            var vizElement = divElement.getElementsByTagName('object')[0];                    
            if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
            else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
            else { vizElement.style.width='100%';vizElement.style.height='1277px';}                     
            var scriptElement = document.createElement('script');                    
            scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                
            </script>

        <p>
            This Dashboard as been created from the table "<b>Continuous_record</b>".
            Several similarities and differences emerge among the users :
            <p><ul class ="bullet-list">
                <li>All the users had an inactivity period on <b>13th march at 01 Am</b> (61mn) except 2 users (4388161847 & 2891001357).</li>
                <li><b>11 users</b> (31.4%) have periods of inactivity <b>beyond the 61 minutes on March 13th</b>.</li>
                <li>Apart from the interruption on March 13th, the interruption periods mainly occur on <b>Tuesdays and Sundays</b>.</li>
                <li>The distribution of interruption periods is very <b>random in terms of hours</b>.</li>
                <li>5 users out of the total population (14%) spent </b>50 hours or more</b> not wearing the device (inactive).</li>
                <li>One of the users had a really abnormal behaviour and didnt wear the device for 224 hours (maybe she/he lost it and found it back)</li>
             </ul>
             <p> <b>Data Inconsistency</b> : There should have been a recurrent inactivity period to charge the device for each user </p>
            </p>
        </p>
        <p class = "subtitle_analysis"><b>SLEEP ANALYSIS</b></p>
        <p> This analysis represented a challenge as there is <b>multiples sources of data</b> for sleeping periods. 
            First, we have to figure out which table we want to use : "<b>Continuous_hours</b>" or "<b>SleepDay</b>" ? 
        </p><p><b>Continuous hours</b> is a more complete table with more data so we'll start to analyse this table.
        </p>
        <div 
        class='tableauPlaceholder' 
        id='viz1739604016364' 
        style='position: relative'><noscript>
            <a href='#'>
                <img alt='SLEEP (from Continuous) ' 
        src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPFromContinuousDASHBOARD&#47;SLEEPfromContinuous&#47;1_rss.png' 
        style='border: none' /></a></noscript>
        <object class='tableauViz'  style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
            <param name='embed_code_version' value='3' /> <param name='site_root' value='' />
            <param name='name' value='SLEEPFromContinuousDASHBOARD&#47;SLEEPfromContinuous' />
            <param name='tabs' value='no' /><param name='toolbar' value='yes' />
            <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPFromContinuousDASHBOARD&#47;SLEEPfromContinuous&#47;1.png' /> 
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='fr-FR' /></object></div>                
            <script type='text/javascript'>                   
            var divElement = document.getElementById('viz1739604016364');                    
            var vizElement = divElement.getElementsByTagName('object')[0];                    
            if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
            else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
            else { vizElement.style.width='100%';vizElement.style.height='1227px';}                     
            var scriptElement = document.createElement('script');                    
            scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
            // vizElement.parentNode.insertBefore(scriptElement, vizElement);                
            </script>
            <p> There are big Inconsistencies in the table "<b>Continuous_hours</b>".
                <p>First, according to the data, users appear to have spent more time asleep than awake, which does not align with normal human habits.
                The average sleep time per day and per user is around <b>10 hours/day</b>. Additionally, 
                the sleep hours are inconsistent, showing a <b>peak at 5:00 PM</b> for users. 
                I have checked the data for duplicates or other issues, but nothing unusual was found. 
                However, the results remain inconsistent. Ive lready noticed that there was a majority of "1" which means "Asleep" in the data
                which made no sense, at first, there was only 1 for Awake, 2 for restless Sleep and 3 Awakening. I added the 0 for "awake" thinking 
                awake and Asleep would balance the sleeping patterns in my data but it remains inconsistent.</p>  <p>So We'll analyse "<b>SleepDay</b>" table instead :</p>
            </p>
            <div 
            class='tableauPlaceholder' 
            id='viz1739604920610' 
            style='position: relative'><noscript><a 
                href='#'>
                <img alt='SLEEP (from SleepDay) ' 
                src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPfromSleepDayDASHBOARD&#47;SLEEPfromSleepDay&#47;1_rss.png' 
                style='border: none' /></a></noscript><object 
                class='tableauViz'  
                style='display:none;'>
                <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                <param name='embed_code_version' value='3' /> <param name='site_root' value='' />
                <param name='name' value='SLEEPfromSleepDayDASHBOARD&#47;SLEEPfromSleepDay' />
                <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPfromSleepDayDASHBOARD&#47;SLEEPfromSleepDay&#47;1.png' /> 
                <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='fr-FR' /></object></div>                
                <script type='text/javascript'>                    var divElement = document.getElementById('viz1739604920610');                    
                var vizElement = divElement.getElementsByTagName('object')[0];                    
                if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
                else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1000px';vizElement.style.height='827px';} 
                else { vizElement.style.width='100%';vizElement.style.height='927px';}                     
                var scriptElement = document.createElement('script');                    
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                </script>
                <p><div 
                class='tableauPlaceholder' 
                id='viz1739660221453' 
                style='position: relative'>
                <noscript><a href='#'>
                    <img 
                    alt='Records SleepDay ' 
                    src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPRecordsHabitsSleepDay&#47;RecordsSleepDay&#47;1_rss.png' 
                    style='border: none' /></a></noscript>
                    <object class='tableauViz'  style='display:none;'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                        <param name='embed_code_version' value='3' /> <param name='site_root' value='' />
                        <param name='name' value='SLEEPRecordsHabitsSleepDay&#47;RecordsSleepDay' />
                        <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SL&#47;SLEEPRecordsHabitsSleepDay&#47;RecordsSleepDay&#47;1.png' /> 
                        <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' />
                        <param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='fr-FR' />
                    </object></div>                
                    <script type='text/javascript'>var divElement = document.getElementById('viz1739660221453');var 
                    vizElement = divElement.getElementsByTagName('object')[0];                    
                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    
                    var scriptElement = document.createElement('script');                    
                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                    </script></p>

                <p>The data in the SleepDay table makes much more sense</p>
                <ul class ="bullet-list">
                    <li>Only <b>24 users</b> recorded their sleep in "<b>SleepDay</b>" table </li>
                    <li><b>9 Out of 24 users (37.5%)</b> recorded their sleep less than 10 times in 2 monthes</li>
                    <li>Most users sleep around </b>7 hours per day.</b></li>
                    <li><b>4 out of 24 users (16%)</b> have unusual sleep habits (either too much or too little sleep), but they are also the ones who recorded the least sleep data.</li>
                    <li><b>3 users out of the 24 (12%)</b> sleep 2 hours or less by night on average</li>
                    <li>On average, users spend <b>39 minutes awake while in bed</b></li>
                    <li><b>2 out of 24 users (8%)</b> stay in bed for more than 2 hours per day. If these users are removed from the population, the average drops to 27 minutes per day</li>
                    <li>On average, users sleep more on Sunday and less on thursday</li>
                 </ul>